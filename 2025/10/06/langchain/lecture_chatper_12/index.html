<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 8.0.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"hoyuo.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.25.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":"flat"},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="이 장에서는 OpenAI의 강력한 Assistants API를 사용하여 한 단계 더 발전된 AI 애플리케이션을 구축합니다. 단순한 일회성 질의응답을 넘어, 대화의 맥락을 기억하고, 외부 도구를 사용하여 정보를 가져오거나 작업을 수행하며, 심지어 사용자가 제공한 파일을 읽고 그 내용을 기반으로 답변하는 ‘AI 비서’를 만드는 전체 과정을 학습합니다. 이 장에">
<meta property="og:type" content="article">
<meta property="og:title" content="12. OpenAI Assistants API로 AI 비서 만들기">
<meta property="og:url" content="https://hoyuo.github.io/2025/10/06/langchain/lecture_chatper_12/index.html">
<meta property="og:site_name" content="Hoyuo&#39;s Blog">
<meta property="og:description" content="이 장에서는 OpenAI의 강력한 Assistants API를 사용하여 한 단계 더 발전된 AI 애플리케이션을 구축합니다. 단순한 일회성 질의응답을 넘어, 대화의 맥락을 기억하고, 외부 도구를 사용하여 정보를 가져오거나 작업을 수행하며, 심지어 사용자가 제공한 파일을 읽고 그 내용을 기반으로 답변하는 ‘AI 비서’를 만드는 전체 과정을 학습합니다. 이 장에">
<meta property="og:locale" content="ko_KR">
<meta property="article:published_time" content="2025-10-05T15:22:00.000Z">
<meta property="article:author" content="Hoyuo">
<meta property="article:tag" content="langchain">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://hoyuo.github.io/2025/10/06/langchain/lecture_chatper_12/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"ko","comments":true,"permalink":"https://hoyuo.github.io/2025/10/06/langchain/lecture_chatper_12/","path":"2025/10/06/langchain/lecture_chatper_12/","title":"12. OpenAI Assistants API로 AI 비서 만들기"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>12. OpenAI Assistants API로 AI 비서 만들기 | Hoyuo's Blog</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js" integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>


  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.10.1/mermaid.min.js","integrity":"sha256-BmQmdWDS8X2OTbrwELWK366LV6escyWhHHe0XCTU/Hk="}}</script>
  <script src="/js/third-party/tags/mermaid.js" defer></script>





  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js" defer></script>



  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Hoyuo's Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Mobile Developer<br/> (Android, iOS, Flutter, RN)</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="검색" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>홈</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>태그<span class="badge">2</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>카테고리<span class="badge">0</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>아카이브<span class="badge">13</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>검색
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="Searching..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          목차
        </li>
        <li class="sidebar-nav-overview">
          흝어보기
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%EC%9D%B4-%EC%9E%A5%EC%97%90%EC%84%9C-%EB%B0%B0%EC%9A%B8-%EB%82%B4%EC%9A%A9"><span class="nav-number">1.</span> <span class="nav-text">이 장에서 배울 내용</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%EC%B2%AB-%EB%B2%88%EC%A7%B8-AI-%EB%B9%84%EC%84%9C-Assistant-%EC%83%9D%EC%84%B1%ED%95%98%EA%B8%B0"><span class="nav-number">2.</span> <span class="nav-text">첫 번째 AI 비서(Assistant) 생성하기</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%ED%95%99%EC%8A%B5-%EB%AA%A9%ED%91%9C"><span class="nav-number">2.1.</span> <span class="nav-text">학습 목표</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%B3%80%EA%B2%BD%EB%90%9C-%ED%8C%8C%EC%9D%BC-notebook-ipynb"><span class="nav-number">2.2.</span> <span class="nav-text">변경된 파일: notebook.ipynb</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%8B%A8%EA%B3%84-1-OpenAI-Assistants-API-%EC%86%8C%EA%B0%9C"><span class="nav-number">2.3.</span> <span class="nav-text">단계 1: OpenAI Assistants API 소개</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%8B%A8%EA%B3%84-2-%EB%8F%84%EA%B5%AC-Tool-%EC%A0%95%EC%9D%98%ED%95%98%EA%B8%B0"><span class="nav-number">2.4.</span> <span class="nav-text">단계 2: 도구(Tool) 정의하기</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%8B%A8%EA%B3%84-3-Assistant-%EC%83%9D%EC%84%B1%ED%95%98%EA%B8%B0"><span class="nav-number">2.5.</span> <span class="nav-text">단계 3: Assistant 생성하기</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%8B%A8%EA%B3%84-4-%EC%83%9D%EC%84%B1-%EA%B2%B0%EA%B3%BC"><span class="nav-number">2.6.</span> <span class="nav-text">단계 4: 생성 결과</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EC%B2%B4%ED%81%AC%EB%A6%AC%EC%8A%A4%ED%8A%B8"><span class="nav-number">2.7.</span> <span class="nav-text">체크리스트</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#AI-%EB%B9%84%EC%84%9C%EC%9D%98-%EB%8F%84%EA%B5%AC-%EC%83%81%EC%9E%90-%EC%B1%84%EC%9A%B0%EA%B8%B0"><span class="nav-number">3.</span> <span class="nav-text">AI 비서의 도구 상자 채우기</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%ED%95%99%EC%8A%B5-%EB%AA%A9%ED%91%9C-1"><span class="nav-number">3.1.</span> <span class="nav-text">학습 목표</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%B3%80%EA%B2%BD%EB%90%9C-%ED%8C%8C%EC%9D%BC-notebook-ipynb-1"><span class="nav-number">3.2.</span> <span class="nav-text">변경된 파일: notebook.ipynb</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%8B%A8%EA%B3%84-1-yfinance-%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC-%EC%86%8C%EA%B0%9C"><span class="nav-number">3.3.</span> <span class="nav-text">단계 1: yfinance 라이브러리 소개</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%8B%A8%EA%B3%84-2-%EC%9E%AC%EB%AC%B4-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A1%B0%ED%9A%8C-%ED%95%A8%EC%88%98-%EA%B5%AC%ED%98%84"><span class="nav-number">3.4.</span> <span class="nav-text">단계 2: 재무 데이터 조회 함수 구현</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%8B%A8%EA%B3%84-3-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A5%BC-%EB%AC%B8%EC%9E%90%EC%97%B4%EB%A1%9C-%EB%B0%98%ED%99%98%ED%95%98%EA%B8%B0"><span class="nav-number">3.5.</span> <span class="nav-text">단계 3: 데이터를 문자열로 반환하기</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%8B%A8%EA%B3%84-4-%ED%95%A8%EC%88%98-%EB%A7%B5%ED%95%91"><span class="nav-number">3.6.</span> <span class="nav-text">단계 4: 함수 맵핑</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EC%B2%B4%ED%81%AC%EB%A6%AC%EC%8A%A4%ED%8A%B8-1"><span class="nav-number">3.7.</span> <span class="nav-text">체크리스트</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#AI-%EB%B9%84%EC%84%9C%EC%99%80-%EB%8C%80%ED%99%94-%EC%8B%9C%EC%9E%91%ED%95%98%EA%B8%B0-Thread%EC%99%80-Run"><span class="nav-number">4.</span> <span class="nav-text">AI 비서와 대화 시작하기: Thread와 Run</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%ED%95%99%EC%8A%B5-%EB%AA%A9%ED%91%9C-2"><span class="nav-number">4.1.</span> <span class="nav-text">학습 목표</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%B3%80%EA%B2%BD%EB%90%9C-%ED%8C%8C%EC%9D%BC-notebook-ipynb-2"><span class="nav-number">4.2.</span> <span class="nav-text">변경된 파일: notebook.ipynb</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%8B%A8%EA%B3%84-1-%EB%8C%80%ED%99%94%EC%9D%98-%EC%8B%9C%EC%9E%91-Thread"><span class="nav-number">4.3.</span> <span class="nav-text">단계 1: 대화의 시작, Thread</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%8B%A8%EA%B3%84-2-Assistant-%EC%8B%A4%ED%96%89-Run"><span class="nav-number">4.4.</span> <span class="nav-text">단계 2: Assistant 실행, Run</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%8B%A8%EA%B3%84-3-%EB%B9%84%EB%8F%99%EA%B8%B0%EC%A0%81-%EC%8B%A4%ED%96%89%EA%B3%BC-%EC%83%81%ED%83%9C-%ED%99%95%EC%9D%B8"><span class="nav-number">4.5.</span> <span class="nav-text">단계 3: 비동기적 실행과 상태 확인</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%8B%A8%EA%B3%84-4-%EB%8C%80%ED%99%94-%EB%82%B4%EC%9A%A9-%EA%B0%80%EC%A0%B8%EC%98%A4%EA%B8%B0"><span class="nav-number">4.6.</span> <span class="nav-text">단계 4: 대화 내용 가져오기</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EC%B2%B4%ED%81%AC%EB%A6%AC%EC%8A%A4%ED%8A%B8-2"><span class="nav-number">4.7.</span> <span class="nav-text">체크리스트</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#AI-%EB%B9%84%EC%84%9C%EC%9D%98-%EC%95%A1%EC%85%98-%EC%8B%A4%ED%96%89%ED%95%98%EA%B8%B0-%EB%8F%84%EA%B5%AC-%ED%98%B8%EC%B6%9C%EA%B3%BC-%EA%B2%B0%EA%B3%BC-%EC%A0%9C%EC%B6%9C"><span class="nav-number">5.</span> <span class="nav-text">AI 비서의 액션 실행하기: 도구 호출과 결과 제출</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%ED%95%99%EC%8A%B5-%EB%AA%A9%ED%91%9C-3"><span class="nav-number">5.1.</span> <span class="nav-text">학습 목표</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%B3%80%EA%B2%BD%EB%90%9C-%ED%8C%8C%EC%9D%BC-notebook-ipynb-3"><span class="nav-number">5.2.</span> <span class="nav-text">변경된 파일: notebook.ipynb</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%8B%A8%EA%B3%84-1-requires-action-%EC%83%81%ED%83%9C"><span class="nav-number">5.3.</span> <span class="nav-text">단계 1: requires_action 상태</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%8B%A8%EA%B3%84-2-%EB%8F%84%EA%B5%AC-%ED%98%B8%EC%B6%9C-Tool-Call-%EC%A0%95%EB%B3%B4-%ED%8C%8C%EC%8B%B1"><span class="nav-number">5.4.</span> <span class="nav-text">단계 2: 도구 호출(Tool Call) 정보 파싱</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%8B%A8%EA%B3%84-3-%EB%8F%84%EA%B5%AC-%EC%8B%A4%ED%96%89-%EB%B0%8F-%EA%B2%B0%EA%B3%BC-%EC%A0%9C%EC%B6%9C"><span class="nav-number">5.5.</span> <span class="nav-text">단계 3: 도구 실행 및 결과 제출</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%8B%A8%EA%B3%84-4-%EC%A0%84%EC%B2%B4-%EB%8C%80%ED%99%94-%ED%9D%90%EB%A6%84"><span class="nav-number">5.6.</span> <span class="nav-text">단계 4: 전체 대화 흐름</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EC%B2%B4%ED%81%AC%EB%A6%AC%EC%8A%A4%ED%8A%B8-3"><span class="nav-number">5.7.</span> <span class="nav-text">체크리스트</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%EB%8C%80%ED%99%94-%EC%9D%B4%EC%96%B4%EA%B0%80%EA%B8%B0-%EB%B0%8F-%EB%A6%AC%ED%8C%A9%ED%86%A0%EB%A7%81"><span class="nav-number">6.</span> <span class="nav-text">대화 이어가기 및 리팩토링</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%ED%95%99%EC%8A%B5-%EB%AA%A9%ED%91%9C-4"><span class="nav-number">6.1.</span> <span class="nav-text">학습 목표</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%B3%80%EA%B2%BD%EB%90%9C-%ED%8C%8C%EC%9D%BC-notebook-ipynb-4"><span class="nav-number">6.2.</span> <span class="nav-text">변경된 파일: notebook.ipynb</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%8B%A8%EA%B3%84-1-%EB%B2%84%EA%B7%B8-%EC%88%98%EC%A0%95-%EB%B0%8F-%EC%BD%94%EB%93%9C-%EA%B0%9C%EC%84%A0"><span class="nav-number">6.3.</span> <span class="nav-text">단계 1: 버그 수정 및 코드 개선</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%8B%A8%EA%B3%84-2-%EB%8C%80%ED%99%94-%EC%9D%B4%EC%96%B4%EA%B0%80%EA%B8%B0"><span class="nav-number">6.4.</span> <span class="nav-text">단계 2: 대화 이어가기</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%8B%A8%EA%B3%84-3-%EC%A0%84%EC%B2%B4-%EB%8C%80%ED%99%94-%EB%B6%84%EC%84%9D"><span class="nav-number">6.5.</span> <span class="nav-text">단계 3: 전체 대화 분석</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EC%B2%B4%ED%81%AC%EB%A6%AC%EC%8A%A4%ED%8A%B8-4"><span class="nav-number">6.6.</span> <span class="nav-text">체크리스트</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RAG-%EB%B9%84%EC%84%9C-%EB%A7%8C%EB%93%A4%EA%B8%B0-%ED%8C%8C%EC%9D%BC-%EA%B8%B0%EB%B0%98-%EC%A7%80%EC%8B%9D%EC%9C%BC%EB%A1%9C-%EB%8B%B5%EB%B3%80%ED%95%98%EA%B8%B0"><span class="nav-number">7.</span> <span class="nav-text">RAG 비서 만들기: 파일 기반 지식으로 답변하기</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%ED%95%99%EC%8A%B5-%EB%AA%A9%ED%91%9C-5"><span class="nav-number">7.1.</span> <span class="nav-text">학습 목표</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%B3%80%EA%B2%BD%EB%90%9C-%ED%8C%8C%EC%9D%BC-notebook-ipynb-5"><span class="nav-number">7.2.</span> <span class="nav-text">변경된 파일: notebook.ipynb</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%8B%A8%EA%B3%84-1-RAG-Retrieval-Augmented-Generation-%EC%86%8C%EA%B0%9C"><span class="nav-number">7.3.</span> <span class="nav-text">단계 1: RAG(Retrieval-Augmented Generation) 소개</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%8B%A8%EA%B3%84-2-retrieval-%EB%8F%84%EA%B5%AC-%ED%99%9C%EC%84%B1%ED%99%94"><span class="nav-number">7.4.</span> <span class="nav-text">단계 2: retrieval 도구 활성화</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%8B%A8%EA%B3%84-3-%ED%8C%8C%EC%9D%BC-%EC%97%85%EB%A1%9C%EB%93%9C-%EB%B0%8F-%EC%8A%A4%EB%A0%88%EB%93%9C%EC%97%90-%EC%97%B0%EA%B2%B0"><span class="nav-number">7.5.</span> <span class="nav-text">단계 3: 파일 업로드 및 스레드에 연결</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EB%8B%A8%EA%B3%84-4-%EB%8B%B5%EB%B3%80-%EC%B6%9C%EC%B2%98-%ED%99%95%EC%9D%B8-Citations"><span class="nav-number">7.6.</span> <span class="nav-text">단계 4: 답변 출처 확인 (Citations)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%EC%B2%B4%ED%81%AC%EB%A6%AC%EC%8A%A4%ED%8A%B8-5"><span class="nav-number">7.7.</span> <span class="nav-text">체크리스트</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Hoyuo</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">13</span>
          <span class="site-state-item-name">포스트</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">태그</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="ko">
    <link itemprop="mainEntityOfPage" href="https://hoyuo.github.io/2025/10/06/langchain/lecture_chatper_12/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Hoyuo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hoyuo's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="12. OpenAI Assistants API로 AI 비서 만들기 | Hoyuo's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          12. OpenAI Assistants API로 AI 비서 만들기
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">작성일</span>

      <time title="Post created: 2025-10-06 00:22" itemprop="dateCreated datePublished" datetime="2025-10-06T00:22:00+09:00">2025-10-06</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>이 장에서는 OpenAI의 강력한 Assistants API를 사용하여 한 단계 더 발전된 AI 애플리케이션을 구축합니다. 단순한 일회성 질의응답을 넘어, 대화의 맥락을 기억하고, 외부 도구를 사용하여 정보를 가져오거나 작업을 수행하며, 심지어 사용자가 제공한 파일을 읽고 그 내용을 기반으로 답변하는 ‘AI 비서’를 만드는 전체 과정을 학습합니다.</p>
<h2 id="이-장에서-배울-내용"><a href="#이-장에서-배울-내용" class="headerlink" title="이 장에서 배울 내용"></a>이 장에서 배울 내용</h2><ul>
<li><strong>Assistants API의 핵심 개념</strong>: Assistant, Thread, Message, Run 등 Assistants API를 구성하는 핵심 객체들의 역할과 관계를 이해합니다.</li>
<li><strong>Tool-Using Assistant</strong>: AI 비서가 웹 검색, 데이터베이스 조회 등 외부 세계와 상호작용할 수 있도록 ‘도구(Tool)’를 정의하고 연결하는 방법을 배웁니다.</li>
<li><strong>상태 관리(Stateful Conversation)</strong>: <code>Thread</code>를 사용하여 여러 차례의 질문과 답변에 걸쳐 대화의 맥락을 유지하는 방법을 익힙니다.</li>
<li><strong>비동기 처리 및 Function Calling</strong>: AI가 도구 사용을 요청할 때(<code>requires_action</code>), 해당 함수를 실행하고 그 결과를 다시 AI에게 전달하는 비동기 상호작용 루프를 구현합니다.</li>
<li><strong>RAG (검색 증강 생성)</strong>: AI 비서에게 파일을 업로드하여 그 내용을 학습시키고, 파일 기반의 질문에 대해 출처를 인용하며 답변하는 RAG(Retrieval-Augmented Generation) 기능을 구현합니다.</li>
</ul>
<hr>
<h2 id="첫-번째-AI-비서-Assistant-생성하기"><a href="#첫-번째-AI-비서-Assistant-생성하기" class="headerlink" title="첫 번째 AI 비서(Assistant) 생성하기"></a>첫 번째 AI 비서(Assistant) 생성하기</h2><p>가장 먼저, AI 비서의 정체성, 지침, 그리고 능력을 정의하는 <code>Assistant</code> 객체를 생성합니다. 이는 우리가 만들 AI 에이전트의 청사진과 같습니다.</p>
<h3 id="학습-목표"><a href="#학습-목표" class="headerlink" title="학습 목표"></a>학습 목표</h3><ul>
<li>OpenAI Assistants API의 기본 개념과 구성 요소(Assistant, Thread, Message, Run) 이해하기</li>
<li>AI 비서가 사용할 수 있는 ‘도구(Tool)’를 JSON 스키마 형식으로 정의하는 방법 배우기</li>
<li><code>openai</code> 라이브러리를 사용하여 새로운 Assistant를 생성하고 설정하는 방법 익히기</li>
</ul>
<h3 id="변경된-파일-notebook-ipynb"><a href="#변경된-파일-notebook-ipynb" class="headerlink" title="변경된 파일: notebook.ipynb"></a>변경된 파일: <code>notebook.ipynb</code></h3><p>이번 장의 모든 개발 과정은 <code>notebook.ipynb</code> 파일 내에서 진행됩니다.</p>
<h3 id="단계-1-OpenAI-Assistants-API-소개"><a href="#단계-1-OpenAI-Assistants-API-소개" class="headerlink" title="단계 1: OpenAI Assistants API 소개"></a>단계 1: OpenAI Assistants API 소개</h3><p>Assistants API는 대화형 AI를 더 쉽고 강력하게 만들 수 있도록 설계되었습니다. 주요 구성 요소는 다음과 같습니다.</p>
<ul>
<li><strong>Assistant</strong>: 특정 목적(예: 투자 분석)을 위해 설정된 AI. 지침, 모델, 사용할 도구 등을 가집니다.</li>
<li><strong>Thread</strong>: 사용자와 Assistant 간의 대화 세션입니다. 하나의 대화와 관련된 모든 메시지를 담습니다.</li>
<li><strong>Message</strong>: Thread에 포함된 각 대화 내용입니다. 사용자 또는 Assistant가 생성할 수 있습니다.</li>
<li><strong>Run</strong>: Assistant가 Thread를 읽고 대화를 진행시키는 작업 단위입니다. Assistant는 메시지를 읽고, 도구를 사용할지, 아니면 텍스트로 답변할지 결정합니다.</li>
</ul>
<h3 id="단계-2-도구-Tool-정의하기"><a href="#단계-2-도구-Tool-정의하기" class="headerlink" title="단계 2: 도구(Tool) 정의하기"></a>단계 2: 도구(Tool) 정의하기</h3><p>Assistant가 웹 검색이나 데이터 조회 같은 특정 작업을 수행하게 하려면, 먼저 어떤 도구를 사용할 수 있는지 알려줘야 합니다. 이는 두 부분으로 구성됩니다.</p>
<ol>
<li><p><strong>실제 함수 구현</strong>: 작업을 수행하는 Python 함수를 만듭니다. 여기서는 DuckDuckGo 검색을 통해 회사의 티커 심볼을 찾는 <code>get_ticker</code> 함수를 예시로 정의합니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.utilities.duckduckgo_search <span class="keyword">import</span> DuckDuckGoSearchAPIWrapper</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_ticker</span>(<span class="params">inputs</span>):</span><br><span class="line">    ddg = DuckDuckGoSearchAPIWrapper()</span><br><span class="line">    company_name = inputs[<span class="string">&quot;company_name&quot;</span>]</span><br><span class="line">    <span class="keyword">return</span> ddg.run(<span class="string">f&quot;Ticker symbol of <span class="subst">&#123;company_name&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>함수 스키마 정의</strong>: AI 모델이 함수를 이해할 수 있도록, 함수의 이름, 설명, 필요한 인자 등을 정해진 JSON 형식으로 설명해 줍니다. 아직 구현되지 않은 함수들도 미리 스키마로 정의하여 Assistant에게 능력을 알려줄 수 있습니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">functions = [</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;function&quot;</span>,</span><br><span class="line">        <span class="string">&quot;function&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;name&quot;</span>: <span class="string">&quot;get_ticker&quot;</span>,</span><br><span class="line">            <span class="string">&quot;description&quot;</span>: <span class="string">&quot;Given the name of a company returns its ticker symbol&quot;</span>,</span><br><span class="line">            <span class="string">&quot;parameters&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,</span><br><span class="line">                <span class="string">&quot;properties&quot;</span>: &#123;</span><br><span class="line">                    <span class="string">&quot;company_name&quot;</span>: &#123;</span><br><span class="line">                        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;description&quot;</span>: <span class="string">&quot;The name of the company&quot;</span>,</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="string">&quot;required&quot;</span>: [<span class="string">&quot;company_name&quot;</span>],</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment"># get_income_statement, get_balance_sheet 등 다른 함수 스키마들...</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="단계-3-Assistant-생성하기"><a href="#단계-3-Assistant-생성하기" class="headerlink" title="단계 3: Assistant 생성하기"></a>단계 3: Assistant 생성하기</h3><p>이제 <code>openai</code> 클라이언트를 사용하여 위에서 정의한 내용을 바탕으로 Assistant를 생성합니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> openai <span class="keyword">as</span> client</span><br><span class="line"></span><br><span class="line">assistant = client.beta.assistants.create(</span><br><span class="line">    name=<span class="string">&quot;Investor Assistant&quot;</span>,</span><br><span class="line">    instructions=<span class="string">&quot;You help users do research on publicly traded companies and you help users decide if they should buy the stock or not.&quot;</span>,</span><br><span class="line">    model=<span class="string">&quot;gpt-4-1106-preview&quot;</span>,</span><br><span class="line">    tools=functions,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<ul>
<li><code>name</code>: Assistant의 이름입니다.</li>
<li><code>instructions</code>: Assistant의 역할과 행동 지침을 정의하는 가장 중요한 부분입니다. 일종의 시스템 프롬프트입니다.</li>
<li><code>model</code>: 사용할 GPT 모델을 지정합니다.</li>
<li><code>tools</code>: 위에서 정의한 함수 스키마 리스트를 전달하여 Assistant가 사용할 수 있는 도구들을 알려줍니다.</li>
</ul>
<h3 id="단계-4-생성-결과"><a href="#단계-4-생성-결과" class="headerlink" title="단계 4: 생성 결과"></a>단계 4: 생성 결과</h3><p>이 코드를 실행하면 OpenAI 서버에 <code>Investor Assistant</code>라는 설정값을 가진 Assistant 객체가 영구적으로 생성됩니다. 이 Assistant는 고유한 ID를 가지게 되며, 우리는 앞으로 이 ID를 사용하여 Assistant를 호출하고 대화를 나눌 수 있습니다.</p>
<h3 id="체크리스트"><a href="#체크리스트" class="headerlink" title="체크리스트"></a>체크리스트</h3><ul>
<li><input disabled="" type="checkbox"> Assistant, Thread, Message, Run의 기본 개념을 이해했나요?</li>
<li><input disabled="" type="checkbox"> Assistant에게 ‘도구’를 제공하는 것이 어떤 의미인지 이해했나요?</li>
<li><input disabled="" type="checkbox"> 함수의 기능을 설명하는 JSON 스키마를 작성할 수 있나요?</li>
<li><input disabled="" type="checkbox"> <code>client.beta.assistants.create</code>를 사용하여 새로운 Assistant를 만들 수 있나요?</li>
</ul>
<hr>
<h2 id="AI-비서의-도구-상자-채우기"><a href="#AI-비서의-도구-상자-채우기" class="headerlink" title="AI 비서의 도구 상자 채우기"></a>AI 비서의 도구 상자 채우기</h2><p>이전 단계에서 AI 비서가 무엇을 할 수 있는지 ‘설명’했다면, 이제는 그 설명을 실제로 수행할 Python 코드를 구현할 차례입니다. <code>yfinance</code> 라이브러리를 사용하여 주식 시장 데이터를 가져오는 실제 도구 함수들을 만듭니다.</p>
<h3 id="학습-목표-1"><a href="#학습-목표-1" class="headerlink" title="학습 목표"></a>학습 목표</h3><ul>
<li><code>yfinance</code> 라이브러리를 사용하여 주식 티커로 실제 재무 데이터를 가져오는 방법 배우기</li>
<li>도구 스키마에 정의된 함수들을 실제 Python 코드로 구현하는 방법 익히기</li>
<li>Pandas DataFrame을 AI가 처리할 수 있는 JSON 문자열로 변환하는 이유와 방법 이해하기</li>
</ul>
<h3 id="변경된-파일-notebook-ipynb-1"><a href="#변경된-파일-notebook-ipynb-1" class="headerlink" title="변경된 파일: notebook.ipynb"></a>변경된 파일: <code>notebook.ipynb</code></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># notebook.ipynb</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> yfinance</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="comment"># ... (get_ticker 함수 생략)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_income_statement</span>(<span class="params">inputs</span>):</span><br><span class="line">    ticker = inputs[<span class="string">&quot;ticker&quot;</span>]</span><br><span class="line">    stock = yfinance.Ticker(ticker)</span><br><span class="line">    <span class="keyword">return</span> json.dumps(stock.income_stmt.to_json())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_balance_sheet</span>(<span class="params">inputs</span>):</span><br><span class="line">    ticker = inputs[<span class="string">&quot;ticker&quot;</span>]</span><br><span class="line">    stock = yfinance.Ticker(ticker)</span><br><span class="line">    <span class="keyword">return</span> json.dumps(stock.balance_sheet.to_json())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_daily_stock_performance</span>(<span class="params">inputs</span>):</span><br><span class="line">    ticker = inputs[<span class="string">&quot;ticker&quot;</span>]</span><br><span class="line">    stock = yfinance.Ticker(ticker)</span><br><span class="line">    <span class="keyword">return</span> json.dumps(stock.history(period=<span class="string">&quot;3mo&quot;</span>).to_json())</span><br><span class="line"></span><br><span class="line">functions_map = &#123;</span><br><span class="line">    <span class="string">&quot;get_ticker&quot;</span>: get_ticker,</span><br><span class="line">    <span class="string">&quot;get_income_statement&quot;</span>: get_income_statement,</span><br><span class="line">    <span class="string">&quot;get_balance_sheet&quot;</span>: get_balance_sheet,</span><br><span class="line">    <span class="string">&quot;get_daily_stock_performance&quot;</span>: get_daily_stock_performance,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># ... (이하 생략)</span></span><br></pre></td></tr></table></figure>

<h3 id="단계-1-yfinance-라이브러리-소개"><a href="#단계-1-yfinance-라이브러리-소개" class="headerlink" title="단계 1: yfinance 라이브러리 소개"></a>단계 1: <code>yfinance</code> 라이브러리 소개</h3><p><code>yfinance</code>는 Yahoo! Finance에서 제공하는 주식 시장 데이터를 파이썬으로 쉽게 다운로드할 수 있게 해주는 매우 유용한 라이브러리입니다.</p>
<h3 id="단계-2-재무-데이터-조회-함수-구현"><a href="#단계-2-재무-데이터-조회-함수-구현" class="headerlink" title="단계 2: 재무 데이터 조회 함수 구현"></a>단계 2: 재무 데이터 조회 함수 구현</h3><p>이전 단계에서 스키마로만 정의했던 함수들의 실제 내용을 <code>yfinance</code>를 사용하여 구현합니다.</p>
<ul>
<li><code>get_income_statement(inputs)</code>: <code>yfinance.Ticker(ticker)</code>로 특정 주식 객체를 가져온 뒤, <code>.income_stmt</code> 속성을 통해 손익계산서 정보를 가져옵니다.</li>
<li><code>get_balance_sheet(inputs)</code>: 같은 방식으로 <code>.balance_sheet</code> 속성을 통해 대차대조표 정보를 가져옵니다.</li>
<li><code>get_daily_stock_performance(inputs)</code>: <code>.history(period=&quot;3mo&quot;)</code> 메소드를 호출하여 최근 3개월간의 주가 데이터를 가져옵니다.</li>
</ul>
<h3 id="단계-3-데이터를-문자열로-반환하기"><a href="#단계-3-데이터를-문자열로-반환하기" class="headerlink" title="단계 3: 데이터를 문자열로 반환하기"></a>단계 3: 데이터를 문자열로 반환하기</h3><p>Assistant API의 도구 함수가 반환하는 값은 반드시 **문자열(string)**이어야 합니다. <code>yfinance</code>가 반환하는 데이터는 주로 Pandas DataFrame이라는 복잡한 테이블 형태의 객체이므로, 이를 그대로 반환할 수 없습니다.</p>
<p>따라서 <code>.to_json()</code> 메소드로 DataFrame을 JSON 형태의 문자열로 변환하고, <code>json.dumps()</code>를 한 번 더 사용하여 전체를 완전한 문자열로 만들어 반환합니다. 이렇게 해야 AI Assistant가 그 결과를 읽고 해석할 수 있습니다.</p>
<h3 id="단계-4-함수-맵핑"><a href="#단계-4-함수-맵핑" class="headerlink" title="단계 4: 함수 맵핑"></a>단계 4: 함수 맵핑</h3><p><code>functions_map</code> 딕셔너리는 나중에 AI가 “<code>get_income_statement</code> 함수를 호출해줘” 라고 요청했을 때, 문자열 이름(<code>&quot;get_income_statement&quot;</code>)을 실제 파이썬 함수(<code>get_income_statement</code>)와 연결해주는 역할을 합니다.</p>
<h3 id="체크리스트-1"><a href="#체크리스트-1" class="headerlink" title="체크리스트"></a>체크리스트</h3><ul>
<li><input disabled="" type="checkbox"> <code>yfinance</code> 라이브러리로 주식 정보를 가져올 수 있나요?</li>
<li><input disabled="" type="checkbox"> 도구 함수의 반환값이 왜 반드시 문자열이어야 하는지 이해했나요?</li>
<li><input disabled="" type="checkbox"> Pandas DataFrame을 <code>.to_json()</code>을 사용해 문자열로 변환할 수 있나요?</li>
</ul>
<hr>
<h2 id="AI-비서와-대화-시작하기-Thread와-Run"><a href="#AI-비서와-대화-시작하기-Thread와-Run" class="headerlink" title="AI 비서와 대화 시작하기: Thread와 Run"></a>AI 비서와 대화 시작하기: Thread와 Run</h2><p>Assistant를 만들었으니, 이제 실제로 대화를 시작해 봅니다. Assistants API에서는 하나의 대화 단위를 ‘Thread’라고 부르며, Assistant가 이 Thread를 읽고 응답을 생성하는 행위를 ‘Run’이라고 합니다.</p>
<h3 id="학습-목표-2"><a href="#학습-목표-2" class="headerlink" title="학습 목표"></a>학습 목표</h3><ul>
<li>Assistants API의 핵심 객체인 <code>Thread</code>와 <code>Run</code>의 개념과 역할을 이해하기</li>
<li>사용자 메시지를 포함하여 새로운 대화(<code>Thread</code>)를 시작하는 방법 배우기</li>
<li>특정 <code>Assistant</code>가 <code>Thread</code>를 처리하도록 <code>Run</code>을 생성하고 실행하는 방법 익히기</li>
<li><code>Run</code>의 비동기적 특성과 상태를 확인해야 하는 이유 이해하기</li>
</ul>
<h3 id="변경된-파일-notebook-ipynb-2"><a href="#변경된-파일-notebook-ipynb-2" class="headerlink" title="변경된 파일: notebook.ipynb"></a>변경된 파일: <code>notebook.ipynb</code></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># notebook.ipynb</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ... (상단 생략)</span></span><br><span class="line"></span><br><span class="line">assistant_id = <span class="string">&quot;asst_RJHxXodfpEkpDGua4NL2wXAC&quot;</span> <span class="comment"># 생성된 Assistant ID 사용</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 사용자의 첫 메시지를 포함하여 새로운 Thread 생성</span></span><br><span class="line">thread = client.beta.threads.create(</span><br><span class="line">    messages=[</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>,</span><br><span class="line">            <span class="string">&quot;content&quot;</span>: <span class="string">&quot;I want to know if the Salesforce stock is a good buy&quot;</span>,</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 생성된 Thread ID와 Assistant ID를 사용하여 Run 생성</span></span><br><span class="line">run = client.beta.threads.runs.create(</span><br><span class="line">    thread_id=thread.<span class="built_in">id</span>,</span><br><span class="line">    assistant_id=assistant_id,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. Run의 상태를 확인하고, Thread의 메시지를 가져오는 헬퍼 함수 정의</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_run</span>(<span class="params">run_id, thread_id</span>):</span><br><span class="line">    <span class="keyword">return</span> client.beta.threads.runs.retrieve(</span><br><span class="line">        run_id=run_id,</span><br><span class="line">        thread_id=thread_id,</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_messages</span>(<span class="params">thread_id</span>):</span><br><span class="line">    messages = client.beta.threads.messages.<span class="built_in">list</span>(thread_id=thread_id)</span><br><span class="line">    messages = <span class="built_in">list</span>(messages)</span><br><span class="line">    messages.reverse()</span><br><span class="line">    <span class="keyword">for</span> message <span class="keyword">in</span> messages:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;message.role&#125;</span>: <span class="subst">&#123;message.content[<span class="number">0</span>].text.value&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 대화 내용 확인</span></span><br><span class="line">get_messages(thread.<span class="built_in">id</span>)</span><br></pre></td></tr></table></figure>

<h3 id="단계-1-대화의-시작-Thread"><a href="#단계-1-대화의-시작-Thread" class="headerlink" title="단계 1: 대화의 시작, Thread"></a>단계 1: 대화의 시작, Thread</h3><p><code>Thread</code>는 사용자와 Assistant 간의 대화 그 자체입니다. <code>client.beta.threads.create()</code>를 호출하여 새로운 대화를 시작할 수 있으며, <code>messages</code> 인자를 통해 사용자의 첫 질문을 포함시킬 수 있습니다.</p>
<h3 id="단계-2-Assistant-실행-Run"><a href="#단계-2-Assistant-실행-Run" class="headerlink" title="단계 2: Assistant 실행, Run"></a>단계 2: Assistant 실행, Run</h3><p><code>Run</code>은 특정 Assistant에게 특정 Thread를 처리하라고 지시하는 작업입니다. <code>client.beta.threads.runs.create()</code>를 호출하며, 어떤 Assistant(<code>assistant_id</code>)가 어떤 대화(<code>thread_id</code>)를 읽고 응답해야 하는지 알려줍니다.</p>
<h3 id="단계-3-비동기적-실행과-상태-확인"><a href="#단계-3-비동기적-실행과-상태-확인" class="headerlink" title="단계 3: 비동기적 실행과 상태 확인"></a>단계 3: 비동기적 실행과 상태 확인</h3><p><code>Run</code>을 생성하면 API는 즉시 <code>Run</code> 객체를 반환하지만, Assistant가 응답을 생성하는 작업은 백그라운드에서 비동기적으로 수행됩니다. 따라서 우리는 <code>Run</code>의 상태를 주기적으로 확인하여 작업이 완료되었는지, 아니면 도구 사용과 같은 추가 조치가 필요한지 알아내야 합니다. <code>get_run</code> 함수는 바로 이 <code>Run</code>의 현재 상태를 가져오는 역할을 합니다.</p>
<h3 id="단계-4-대화-내용-가져오기"><a href="#단계-4-대화-내용-가져오기" class="headerlink" title="단계 4: 대화 내용 가져오기"></a>단계 4: 대화 내용 가져오기</h3><p><code>Run</code>이 완료되면, Assistant는 자신의 응답을 <code>Message</code> 객체로 만들어 해당 <code>Thread</code>에 추가합니다. <code>get_messages</code> 함수는 특정 <code>Thread</code>의 모든 메시지 기록을 시간 순으로 가져와 보여줍니다.</p>
<p>노트북의 실행 결과를 보면, Assistant가 사용자의 질문을 이해하고, 자신이 가진 도구들을 활용하여 어떻게 답변을 할 것인지 체계적인 계획을 세워 사용자에게 먼저 제안하는 것을 볼 수 있습니다. 이는 Assistant가 자신의 <code>instructions</code>와 <code>tools</code> 정보를 바탕으로 스스로 추론한 결과입니다.</p>
<h3 id="체크리스트-2"><a href="#체크리스트-2" class="headerlink" title="체크리스트"></a>체크리스트</h3><ul>
<li><input disabled="" type="checkbox"> <code>Thread</code>가 대화 세션을 의미한다는 것을 이해했나요?</li>
<li><input disabled="" type="checkbox"> <code>Run</code>이 Assistant를 특정 Thread에 대해 실행시키는 작업임을 이해했나요?</li>
<li><input disabled="" type="checkbox"> <code>Run</code>이 비동기적으로 처리된다는 것의 의미를 알고 있나요?</li>
<li><input disabled="" type="checkbox"> <code>get_messages</code>를 통해 대화의 전체 내용을 확인할 수 있나요?</li>
</ul>
<hr>
<h2 id="AI-비서의-액션-실행하기-도구-호출과-결과-제출"><a href="#AI-비서의-액션-실행하기-도구-호출과-결과-제출" class="headerlink" title="AI 비서의 액션 실행하기: 도구 호출과 결과 제출"></a>AI 비서의 액션 실행하기: 도구 호출과 결과 제출</h2><p>Assistant가 도구를 사용하겠다고 결정하면, <code>Run</code>의 상태는 <code>requires_action</code>으로 바뀝니다. 이는 우리 애플리케이션에게 “이제 네가 나설 차례야. 내가 요청한 함수를 실행하고 결과를 알려줘”라고 신호를 보내는 것과 같습니다. 이 단계에서는 그 신호를 받아 실제 도구를 실행하고 결과를 다시 Assistant에게 전달하는 과정을 구현합니다.</p>
<h3 id="학습-목표-3"><a href="#학습-목표-3" class="headerlink" title="학습 목표"></a>학습 목표</h3><ul>
<li><code>Run</code> 객체의 <code>requires_action</code> 상태의 의미를 이해하기</li>
<li>AI가 요청한 도구 호출(Tool Call) 정보를 파싱하는 방법 배우기</li>
<li>요청된 함수를 동적으로 실행하고, 그 결과를 다시 AI 비서에게 제출하는 전체 흐름 이해하기</li>
</ul>
<h3 id="변경된-파일-notebook-ipynb-3"><a href="#변경된-파일-notebook-ipynb-3" class="headerlink" title="변경된 파일: notebook.ipynb"></a>변경된 파일: <code>notebook.ipynb</code></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># notebook.ipynb</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ... (상단 생략)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_tool_outputs</span>(<span class="params">run_id, thread_id</span>):</span><br><span class="line">    run = get_run(run_id, thread_id)</span><br><span class="line">    outputs = []</span><br><span class="line">    <span class="comment"># 1. AI가 요청한 모든 도구 호출 목록을 순회</span></span><br><span class="line">    <span class="keyword">for</span> action <span class="keyword">in</span> run.required_action.submit_tool_outputs.tool_calls:</span><br><span class="line">        action_id = action.<span class="built_in">id</span></span><br><span class="line">        function = action.function</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Calling function: <span class="subst">&#123;function.name&#125;</span> with arg <span class="subst">&#123;function.arguments&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 2. functions_map을 사용해 실제 Python 함수를 찾아 실행</span></span><br><span class="line">        outputs.append(</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">&quot;output&quot;</span>: functions_map[function.name](json.loads(function.arguments)),</span><br><span class="line">                <span class="string">&quot;tool_call_id&quot;</span>: action_id,</span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line">    <span class="keyword">return</span> outputs</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">submit_tool_outputs</span>(<span class="params">run_id, thread_id</span>):</span><br><span class="line">    outpus = get_tool_outputs(run_id, thread_id)</span><br><span class="line">    <span class="comment"># 3. 실행 결과를 다시 Assistant에게 제출</span></span><br><span class="line">    <span class="keyword">return</span> client.beta.threads.runs.submit_tool_outputs(</span><br><span class="line">        run_id=run_id, thread_id=thread_id, tool_outputs=outpus</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"><span class="comment"># --- 실행 흐름 ---</span></span><br><span class="line"><span class="comment"># 이전 Run이 requires_action 상태가 된 후...</span></span><br><span class="line">submit_tool_outputs(run.<span class="built_in">id</span>, thread.<span class="built_in">id</span>)</span><br></pre></td></tr></table></figure>

<h3 id="단계-1-requires-action-상태"><a href="#단계-1-requires-action-상태" class="headerlink" title="단계 1: requires_action 상태"></a>단계 1: <code>requires_action</code> 상태</h3><p>사용자가 “계속 진행해줘”라고 답하고 새로운 <code>Run</code>을 생성하면, Assistant는 계획에 따라 도구를 사용해야 한다고 판단합니다. 이때 <code>Run</code>의 상태는 <code>completed</code>가 아닌 <code>requires_action</code>이 됩니다. 이는 Assistant가 우리 쪽의 응답을 기다리며 일시정지했음을 의미합니다.</p>
<h3 id="단계-2-도구-호출-Tool-Call-정보-파싱"><a href="#단계-2-도구-호출-Tool-Call-정보-파싱" class="headerlink" title="단계 2: 도구 호출(Tool Call) 정보 파싱"></a>단계 2: 도구 호출(Tool Call) 정보 파싱</h3><p><code>run.required_action.submit_tool_outputs.tool_calls</code> 객체에는 Assistant가 호출하려는 함수들의 목록이 들어있습니다. <code>get_tool_outputs</code> 함수는 이 목록을 순회하며 각 함수 호출(<code>action</code>)에 필요한 정보를 추출합니다.</p>
<ul>
<li><code>action.id</code>: 각 도구 호출을 식별하는 고유 ID. 나중에 결과를 제출할 때 이 ID를 함께 보내야 합니다.</li>
<li><code>action.function.name</code>: 호출할 함수의 이름 (예: <code>&quot;get_ticker&quot;</code>)</li>
<li><code>action.function.arguments</code>: 함수에 전달할 인자를 담은 JSON <strong>문자열</strong> (예: <code>&#39;{&quot;company_name&quot;: &quot;Salesforce&quot;}&#39;</code>)</li>
</ul>
<h3 id="단계-3-도구-실행-및-결과-제출"><a href="#단계-3-도구-실행-및-결과-제출" class="headerlink" title="단계 3: 도구 실행 및 결과 제출"></a>단계 3: 도구 실행 및 결과 제출</h3><p><code>get_tool_outputs</code> 함수는 <code>functions_map</code> 딕셔너리를 사용하여 함수 이름에 해당하는 실제 Python 함수를 찾습니다. <code>json.loads()</code>를 사용해 인자 문자열을 Python 딕셔너리로 변환한 뒤, 함수를 실행합니다.</p>
<p><code>submit_tool_outputs</code> 함수는 이렇게 실행된 모든 도구의 결과(<code>outputs</code>)를 모아, <code>client.beta.threads.runs.submit_tool_outputs</code> API를 호출하여 Assistant에게 다시 전달합니다. 이로써 상호작용의 한 사이클이 마무리됩니다.</p>
<p>결과를 제출받은 Assistant는 <code>Run</code>을 재개하고, 이제 도구로부터 얻은 실제 데이터를 바탕으로 사용자에게 최종 답변을 생성하여 <code>Thread</code>에 추가합니다.</p>
<h3 id="단계-4-전체-대화-흐름"><a href="#단계-4-전체-대화-흐름" class="headerlink" title="단계 4: 전체 대화 흐름"></a>단계 4: 전체 대화 흐름</h3><p>이 커밋의 노트북 실행 결과는 이 모든 과정을 보여줍니다.</p>
<p><code>사용자 질문</code> → <code>Assistant의 분석 계획 제시</code> → <code>사용자의 진행 승인</code> → <code>Assistant의 도구 사용 요청 (requires_action)</code> → <code>우리 코드의 도구 실행 및 결과 제출</code> → <code>Assistant의 최종 답변 생성 (completed)</code></p>
<h3 id="체크리스트-3"><a href="#체크리스트-3" class="headerlink" title="체크리스트"></a>체크리스트</h3><ul>
<li><input disabled="" type="checkbox"> <code>Run</code>의 <code>requires_action</code> 상태가 무엇을 의미하는지 설명할 수 있나요?</li>
<li><input disabled="" type="checkbox"> <code>tool_calls</code> 객체에서 함수 이름과 인자 문자열을 어떻게 추출하는지 알고 있나요?</li>
<li><input disabled="" type="checkbox"> <code>json.loads()</code>를 사용하여 JSON 문자열을 Python 딕셔너리로 변환할 수 있나요?</li>
<li><input disabled="" type="checkbox"> <code>submit_tool_outputs</code>를 사용하여 도구 실행 결과를 Assistant에게 어떻게 전달하는지 이해했나요?</li>
</ul>
<hr>
<h2 id="대화-이어가기-및-리팩토링"><a href="#대화-이어가기-및-리팩토링" class="headerlink" title="대화 이어가기 및 리팩토링"></a>대화 이어가기 및 리팩토링</h2><p>이번 단계에서는 하나의 대화(Thread) 안에서 여러 번 질문과 답변을 주고받으며 대화의 맥락을 이어가는 방법을 배우고, 코드의 가독성과 안정성을 높이기 위한 작은 리팩토링을 진행합니다.</p>
<h3 id="학습-목표-4"><a href="#학습-목표-4" class="headerlink" title="학습 목표"></a>학습 목표</h3><ul>
<li>하나의 <code>Thread</code> 내에서 여러 차례 질문과 답변을 주고받으며 대화를 이어가는 방법 배우기</li>
<li><code>Run</code> -&gt; <code>requires_action</code> -&gt; <code>submit_tool_outputs</code> -&gt; <code>Run</code>으로 이어지는 상호작용 루프를 반복하는 방법 이해하기</li>
<li>코드의 작은 버그를 수정하고 워크플로우를 명확하게 만드는 리팩토링의 중요성 파악하기</li>
</ul>
<h3 id="변경된-파일-notebook-ipynb-4"><a href="#변경된-파일-notebook-ipynb-4" class="headerlink" title="변경된 파일: notebook.ipynb"></a>변경된 파일: <code>notebook.ipynb</code></h3><h3 id="단계-1-버그-수정-및-코드-개선"><a href="#단계-1-버그-수정-및-코드-개선" class="headerlink" title="단계 1: 버그 수정 및 코드 개선"></a>단계 1: 버그 수정 및 코드 개선</h3><p>이전 코드의 <code>get_tool_outputs</code> 함수 안에는 작은 버그가 있었습니다.</p>
<ul>
<li><strong>기존</strong>: <code>run = get_run(run_id, thread.id)</code></li>
<li><strong>수정</strong>: <code>run = get_run(run_id, thread_id)</code></li>
</ul>
<p>함수 외부의 전역 변수 <code>thread</code>에 의존하던 것을, 함수에 인자로 전달된 <code>thread_id</code>를 사용하도록 수정했습니다. 이렇게 해야 이 함수를 다른 스레드에서도 재사용할 수 있는 독립적이고 안정적인 코드가 됩니다.</p>
<h3 id="단계-2-대화-이어가기"><a href="#단계-2-대화-이어가기" class="headerlink" title="단계 2: 대화 이어가기"></a>단계 2: 대화 이어가기</h3><p>Assistant와의 대화를 이어가려면 어떻게 해야 할까요? 새로운 <code>Thread</code>를 만드는 대신, 기존 <code>Thread</code>에 새로운 사용자 메시지를 추가하면 됩니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 새로운 사용자 메시지를 기존 스레드에 추가</span></span><br><span class="line">send_message(thread.<span class="built_in">id</span>, <span class="string">&quot;Now I want to know if Cloudflare is a good buy.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 동일한 스레드와 어시스턴트에 대해 새로운 Run을 생성</span></span><br><span class="line">run = client.beta.threads.runs.create(</span><br><span class="line">    thread_id=thread.<span class="built_in">id</span>,</span><br><span class="line">    assistant_id=assistant_id,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>새로운 메시지를 추가한 뒤, 다시 <code>client.beta.threads.runs.create</code>를 호출하면 Assistant는 이전 대화 내용을 모두 기억한 상태에서 새로운 질문에 대한 응답을 시작합니다.</p>
<h3 id="단계-3-전체-대화-분석"><a href="#단계-3-전체-대화-분석" class="headerlink" title="단계 3: 전체 대화 분석"></a>단계 3: 전체 대화 분석</h3><p>노트북의 최종 실행 결과를 보면, “Salesforce”에 대한 분석이 끝난 뒤 사용자가 “Cloudflare는 어때?”라고 묻자, Assistant가 이전과 동일한 분석 프로세스(티커 검색, 재무제표 조회 등)를 Cloudflare에 대해 다시 수행하고 상세한 분석 결과를 제공하는 것을 볼 수 있습니다. 이는 Assistant가 <code>Thread</code> 내의 전체 대화 맥락을 이해하고 있음을 보여줍니다.</p>
<h3 id="체크리스트-4"><a href="#체크리스트-4" class="headerlink" title="체크리스트"></a>체크리스트</h3><ul>
<li><input disabled="" type="checkbox"> 함수를 작성할 때 전역 변수 대신 인자를 사용해야 하는 이유를 이해했나요?</li>
<li><input disabled="" type="checkbox"> 기존 대화에 새로운 메시지를 추가하는 <code>send_message</code> 함수의 역할을 이해했나요?</li>
<li><input disabled="" type="checkbox"> 하나의 <code>Thread</code>에서 대화를 이어가기 위해 새로운 <code>Run</code>을 생성해야 함을 알고 있나요?</li>
</ul>
<hr>
<h2 id="RAG-비서-만들기-파일-기반-지식으로-답변하기"><a href="#RAG-비서-만들기-파일-기반-지식으로-답변하기" class="headerlink" title="RAG 비서 만들기: 파일 기반 지식으로 답변하기"></a>RAG 비서 만들기: 파일 기반 지식으로 답변하기</h2><p>지금까지 Assistant는 외부 함수(도구)를 호출하여 정보를 얻었습니다. 이번에는 완전히 다른 접근법인 **검색 증강 생성(Retrieval-Augmented Generation, RAG)**을 사용합니다. Assistant에게 파일을 업로드하여 새로운 지식을 학습시키고, 그 파일의 내용을 기반으로 질문에 답변하도록 만들어 봅니다.</p>
<h3 id="학습-목표-5"><a href="#학습-목표-5" class="headerlink" title="학습 목표"></a>학습 목표</h3><ul>
<li>검색 증강 생성(RAG)의 개념과 AI 비서에 파일을 업로드하여 지식을 확장하는 방법 이해하기</li>
<li>Assistants API의 내장 <code>retrieval</code> 도구를 활성화하는 방법 배우기</li>
<li><code>client.files.create</code>를 사용하여 파일을 업로드하고, 메시지에 <code>file_ids</code>를 포함하여 스레드에 연결하는 방법 익히기</li>
<li>AI가 파일 내용을 참조하여 답변하고, 그 출처(citation)를 표시하는 과정 확인하기</li>
</ul>
<h3 id="변경된-파일-notebook-ipynb-5"><a href="#변경된-파일-notebook-ipynb-5" class="headerlink" title="변경된 파일: notebook.ipynb"></a>변경된 파일: <code>notebook.ipynb</code></h3><p>Investor Assistant 관련 코드는 모두 삭제되고, 파일 기반 질의응답을 위한 새로운 코드로 대체됩니다.</p>
<h3 id="단계-1-RAG-Retrieval-Augmented-Generation-소개"><a href="#단계-1-RAG-Retrieval-Augmented-Generation-소개" class="headerlink" title="단계 1: RAG(Retrieval-Augmented Generation) 소개"></a>단계 1: RAG(Retrieval-Augmented Generation) 소개</h3><p>RAG는 AI 모델이 답변을 생성할 때, 외부의 신뢰할 수 있는 지식 소스(예: 우리가 업로드한 문서)를 먼저 ‘검색(Retrieval)’하고, 검색된 관련 정보를 ‘근거’로 삼아 답변을 ‘생성(Generation)’하는 기술입니다. 이를 통해 모델의 지식에만 의존할 때 발생할 수 있는 환각(Hallucination) 현상을 줄이고, 특정 도메인에 대한 정확하고 상세한 답변을 제공할 수 있습니다.</p>
<h3 id="단계-2-retrieval-도구-활성화"><a href="#단계-2-retrieval-도구-활성화" class="headerlink" title="단계 2: retrieval 도구 활성화"></a>단계 2: <code>retrieval</code> 도구 활성화</h3><p>Assistant에 RAG 기능을 활성화하는 것은 매우 간단합니다. Assistant를 생성하거나 수정할 때, <code>tools</code> 목록에 <code>{&quot;type&quot;: &quot;retrieval&quot;}</code>을 추가하기만 하면 됩니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Assistant 생성 시 retrieval 도구 활성화</span></span><br><span class="line">assistant = client.beta.assistants.create(</span><br><span class="line">    name=<span class="string">&quot;Book Assistant&quot;</span>,</span><br><span class="line">    instructions=<span class="string">&quot;You help users with their question on the files they upload.&quot;</span>,</span><br><span class="line">    model=<span class="string">&quot;gpt-4-1106-preview&quot;</span>,</span><br><span class="line">    tools=[&#123;<span class="string">&quot;type&quot;</span>: <span class="string">&quot;retrieval&quot;</span>&#125;],</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h3 id="단계-3-파일-업로드-및-스레드에-연결"><a href="#단계-3-파일-업로드-및-스레드에-연결" class="headerlink" title="단계 3: 파일 업로드 및 스레드에 연결"></a>단계 3: 파일 업로드 및 스레드에 연결</h3><p>Assistant가 파일을 사용하게 하려면 두 단계가 필요합니다.</p>
<ol>
<li><p><strong>파일 업로드</strong>: <code>client.files.create</code>를 사용하여 로컬 파일을 OpenAI 서버에 업로드합니다. <code>purpose</code>를 <code>&quot;assistants&quot;</code>로 지정해야 합니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">file = client.files.create(</span><br><span class="line">    file=client.file_from_path(<span class="string">&quot;./files/chapter_one.txt&quot;</span>), </span><br><span class="line">    purpose=<span class="string">&quot;assistants&quot;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>스레드에 파일 연결</strong>: 사용자 메시지를 생성할 때 <code>file_ids</code> 인자에 업로드된 파일의 ID를 리스트 형태로 전달합니다. 이렇게 하면 해당 <code>Thread</code> 내에서 Assistant가 이 파일을 참조할 수 있게 됩니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">client.beta.threads.messages.create(</span><br><span class="line">    thread_id=thread.<span class="built_in">id</span>, </span><br><span class="line">    role=<span class="string">&quot;user&quot;</span>, </span><br><span class="line">    content=<span class="string">&quot;&quot;</span>, <span class="comment"># 파일 첨부 시 content는 비워둘 수 있음</span></span><br><span class="line">    file_ids=[file.<span class="built_in">id</span>]</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="단계-4-답변-출처-확인-Citations"><a href="#단계-4-답변-출처-확인-Citations" class="headerlink" title="단계 4: 답변 출처 확인 (Citations)"></a>단계 4: 답변 출처 확인 (Citations)</h3><p>RAG의 가장 강력한 기능 중 하나는 답변의 근거가 된 원본 소스를 명확히 밝혀준다는 것입니다. Assistant가 <code>retrieval</code> 도구를 사용하여 답변을 생성하면, 응답 메시지의 <code>annotations</code> 필드에 <strong>인용(Citation)</strong> 정보가 포함됩니다.</p>
<p><code>get_messages</code> 함수를 약간 수정하여 이 인용 정보를 함께 출력하도록 만들 수 있습니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_messages</span>(<span class="params">thread_id</span>):</span><br><span class="line">    <span class="comment"># ... (기존 코드)</span></span><br><span class="line">    <span class="keyword">for</span> message <span class="keyword">in</span> messages:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;message.role&#125;</span>: <span class="subst">&#123;message.content[<span class="number">0</span>].text.value&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="comment"># Annotation(인용) 정보 출력 추가</span></span><br><span class="line">        <span class="keyword">for</span> annotation <span class="keyword">in</span> message.content[<span class="number">0</span>].text.annotations:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Source: <span class="subst">&#123;annotation.file_citation&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>노트북의 실행 결과를 보면, “윈스턴은 어디에 사나?”라는 질문에 Assistant가 업로드된 <code>chapter_one.txt</code> 파일의 내용을 정확히 인용(<code>【12†source】</code>)하며 답변하는 것을 볼 수 있습니다. 또한 <code>get_messages</code>를 통해 출력된 <code>Source</code> 정보를 보면, 어떤 파일(<code>file_id</code>)의 어떤 구절(<code>quote</code>)을 근거로 답변했는지 투명하게 확인할 수 있습니다.</p>
<h3 id="체크리스트-5"><a href="#체크리스트-5" class="headerlink" title="체크리스트"></a>체크리스트</h3><ul>
<li><input disabled="" type="checkbox"> RAG가 무엇이며 왜 유용한지 설명할 수 있나요?</li>
<li><input disabled="" type="checkbox"> Assistant에 <code>retrieval</code> 도구를 어떻게 활성화하는지 알고 있나요?</li>
<li><input disabled="" type="checkbox"> 파일을 업로드하고 특정 대화(Thread)에 연결하는 과정을 이해했나요?</li>
<li><input disabled="" type="checkbox"> Assistant의 답변에서 출처(Citation)를 확인하는 것이 왜 중요한지 이해했나요?</li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/langchain/" rel="tag"><i class="fa fa-tag"></i> langchain</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/10/06/langchain/lecture_chatper_10/" rel="prev" title="10. InvestorGPT - 자율적으로 조사하고 분석하는 AI 에이전트 만들기">
                  <i class="fa fa-angle-left"></i> 10. InvestorGPT - 자율적으로 조사하고 분석하는 AI 에이전트 만들기
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Hoyuo</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>
